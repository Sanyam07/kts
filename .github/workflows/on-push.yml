name: CI

on: [push]

jobs:
  build:

    runs-on: macos-latest
    strategy:
      fail-fast: false
      matrix:
        python-version: [3.6]

    steps:
    - uses: actions/checkout@v2
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v1
      with:
        python-version: ${{ matrix.python-version }}
    - name: Install dependencies
      run: |
        sudo $(which python) -m pip install --upgrade pip
        sudo $(which python) setup.py develop
    - name: Fix permissions
        sudo chmod 777 /opt/hostedtoolcache/Python/3.6.10/x64/lib/python3.6/site-packages/ray-0.8.1-py3.6-linux-x86_64.egg/ray/core/src/ray/thirdparty/redis/src/redis-server
    - name: Lint
      run: |
        echo Linter is disabled so far
    - name: Test with pytest and obtain coverage
      run: |
        sudo $(which pip) install pytest
        sudo $(which pip) install pytest-cov
        sudo $(which pytest)
#    - name: Upload coverage to Codecov
#      uses: codecov/codecov-action@v1
#      with:
#        token: ${{ secrets.CODECOV_TOKEN }}
#        file: ./coverage.xml
#        name: kts-core
